#!/bin/sh

errno --list | awk '{ names[$2] = $1; if ($2 > max) max = $2; } END {
	printf("/* Autogenerated file */\n");
	for (i = 1; i < max; i++)
	    if (i in names) printf("#define LINUX_%s %d\n", names[i], i);

	printf("static inline int __map_errno(int linux_errno) {\n");
	printf("    switch(linux_errno) {\n");
	for (i = 1; i < max; i++) {
	    if (i in names) {
		printf("    case LINUX_%s:\n", names[i]);
		printf("#ifdef %s\n", names[i]);
		printf("        return %s;\n", names[i]);
		printf("#else\n");
		printf("        return EINVAL;\n");
	    }
	}
	printf("    }\n");
	printf("}\n");
}' > $1
